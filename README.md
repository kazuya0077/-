# 理学療法士向け問診フォーム

地域おこし協力隊の理学療法士が、受診勧奨に必要な情報を整理できるように設計したウェブフォームです。モダンなUIで選択式入力が多く、転倒リスクや厚生労働省の身体活動基準を踏まえた質問項目を網羅しています。個人の住所・連絡先・妊娠出産歴などは収集せず、必要な機能情報に絞っています。

## ファイル構成
- `index.html` – フォーム本体（3KQ・ボディスキーマ選択などを含む）
- `styles.css` – カード型レイアウトとフォームコンポーネントのスタイル
- `script.js` – 条件付き入力の表示制御と Google スプレッドシート送信処理
- `google_apps_script.gs` – スプレッドシート側に配置する Google Apps Script（ウェブアプリ）
- `dev-server.js` – ローカルプレビュー用の軽量 Node.js サーバー
- `scripts/export-static.js` – Vercel など静的ホスティング向けの書き出しスクリプト
- `vercel.json` – Vercel プロジェクト設定（静的書き出しと SPA ルーティング）
- `package.json` – プレビュー・ビルドコマンド定義

## 利用方法
1. ローカルでプレビューする場合は以下のコマンドを実行します。

   ```bash
   npm install
   npm run dev
   ```

   デフォルトでは `http://localhost:4173` でフォームを表示できます。ポートを変えたい場合は `npm run dev -- 3000` のように末尾に数値を指定してください。
2. そのほかの静的ホスティング（GitHub Pages など）を利用する場合は、`npm run build` で生成される `dist` ディレクトリに書き出されたファイル一式または `index.html` などの静的ファイルを配置してください。
3. フォームに情報を入力し、送信すると Google スプレッドシートへ記録されます。

## Google スプレッドシート連携設定
1. Google スプレッドシート（ID: `1X3DzHP-7QIQABGola5QEvZJmpSSe7D9Sue-FWVY0x00`）で「問診回答」という名前のシートを用意します。
2. スプレッドシートで **拡張機能 → Apps Script** を開き、`google_apps_script.gs` の内容を貼り付けて保存します。
3. メニュー **公開 → ウェブアプリケーションとして導入** を選択し、
   - 新しいバージョンを作成
   - 実行するアプリ：`doPost`
   - アプリにアクセスできるユーザー：`全員（匿名含む）`
   として導入します。
4. 発行後に表示されるウェブアプリの URL を `script.js` の `scriptURL` 定数へ設定します。
5. フォームを再読み込みし、テスト送信してスプレッドシートに行が追加されることを確認してください。

### 項目を追加・編集する場合
- 質問項目を変更した際は、スプレッドシートの1行目（ヘッダー）に同じ名前の列があるか確認してください。
- Apps Script は新しいキーが送信された場合に列を自動追加しますが、項目順序を揃えたい場合は手動で調整してください。

## Vercel へのデプロイ
1. Vercel CLI を利用する場合は `npm install -g vercel` を実行し、プロジェクトルートで `vercel login` のあと `vercel` を実行します。
2. 初回デプロイ時に以下のように設定してください。
   - **Framework Preset**: `Other`
   - **Build Command**: `npm run build`
   - **Output Directory**: `dist`
3. コマンドが完了するとプレビュー用の URL（Preview Deployment）が発行され、同じ設定で `vercel --prod` を実行すると本番 URL が更新されます。
4. GUI から設定する場合も Build Command を `npm run build`、Output を `dist` に設定すれば同じ結果が得られます。
5. 以後は `npm run build` で `dist` ディレクトリに静的ファイルが書き出されるため、任意の静的ホスティングサービスへアップロードすることも可能です。

## 注意事項
- フォームには個人情報が含まれるため、公開範囲やアクセス管理に注意してください。
- Apps Script を公開すると URL を知る全てのユーザーからアクセス可能となります。必要に応じて追加の認証方法を導入してください。
- フォームでは氏名や年齢など最小限の個人情報のみを扱います。スプレッドシートの共有範囲にも十分ご注意ください。
